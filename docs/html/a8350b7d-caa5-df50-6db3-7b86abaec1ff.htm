<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Utils.GetInternalColumnWidth Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="GetInternalColumnWidth method" /><meta name="System.Keywords" content="Utils.GetInternalColumnWidth method" /><meta name="Microsoft.Help.F1" content="NanoXLSX.Utils.GetInternalColumnWidth" /><meta name="Microsoft.Help.Id" content="M:NanoXLSX.Utils.GetInternalColumnWidth(System.Single,System.Single,System.Single)" /><meta name="Description" content="Calculates the internal width of a column in characters. This width is used only in the XML documents of worksheets and is usually not exposed to the (Excel) end user" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="NanoXLSX" /><meta name="file" content="a8350b7d-caa5-df50-6db3-7b86abaec1ff" /><meta name="guid" content="a8350b7d-caa5-df50-6db3-7b86abaec1ff" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.5.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">NanoXLSX Library Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/d75eb659-6335-53f6-af7a-81814a21ab7f.htm" title="NanoXLSX Library Documentation" tocid="roottoc">NanoXLSX Library Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/d75eb659-6335-53f6-af7a-81814a21ab7f.htm" title="NanoXLSX" tocid="d75eb659-6335-53f6-af7a-81814a21ab7f">NanoXLSX</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/a1c95b69-06c8-ad79-2974-1fe05b00c7e7.htm" title="NanoXLSX" tocid="a1c95b69-06c8-ad79-2974-1fe05b00c7e7">NanoXLSX</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/b79f8f28-87ab-475c-033b-b06d9b7b5d5f.htm" title="Utils Class" tocid="b79f8f28-87ab-475c-033b-b06d9b7b5d5f">Utils Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/8dcbc997-332a-bb8d-590e-43a0f15593ea.htm" title="Utils Methods" tocid="8dcbc997-332a-bb8d-590e-43a0f15593ea">Utils Methods</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/a8350b7d-caa5-df50-6db3-7b86abaec1ff.htm" title="GetInternalColumnWidth Method " tocid="a8350b7d-caa5-df50-6db3-7b86abaec1ff">GetInternalColumnWidth Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/2bd42309-15a2-bf06-ea6a-68635cb074fe.htm" title="GetInternalPaneSplitHeight Method " tocid="2bd42309-15a2-bf06-ea6a-68635cb074fe">GetInternalPaneSplitHeight Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/ca41227c-28af-b3ea-5fe0-81e7baf18b06.htm" title="GetInternalPaneSplitWidth Method " tocid="ca41227c-28af-b3ea-5fe0-81e7baf18b06">GetInternalPaneSplitWidth Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/dd885cec-9093-e53e-e317-85ef635dc1f9.htm" title="GetInternalRowHeight Method " tocid="dd885cec-9093-e53e-e317-85ef635dc1f9">GetInternalRowHeight Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/04dda933-7ded-fb13-2bb4-a5e2d5e42b2d.htm" title="GetOADateTimeString Method " tocid="04dda933-7ded-fb13-2bb4-a5e2d5e42b2d">GetOADateTimeString Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/ab71aa5b-d4e1-a42a-b37d-e9c31779ffc2.htm" title="GetOATimeString Method " tocid="ab71aa5b-d4e1-a42a-b37d-e9c31779ffc2">GetOATimeString Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/b3a2cb15-adcb-cb1e-2fa3-ceabf6035968.htm" title="ToString Method " tocid="b3a2cb15-adcb-cb1e-2fa3-ceabf6035968">ToString Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/3f97b0d7-1887-d945-7c4b-a8448db9f978.htm" title="ToUpper Method " tocid="3f97b0d7-1887-d945-7c4b-a8448db9f978">ToUpper Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img alt="NanoXLSX" width="70" height="72" src="../icons/NanoXLSX.png" /></td><td class="titleColumn"><h1>Utils<span id="LST264F4DA0_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST264F4DA0_0?cpp=::|nu=.");</script>GetInternalColumnWidth Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Calculates the internal width of a column in characters. This width is used only in the XML documents of worksheets and is usually not exposed to the (Excel) end user
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="a1c95b69-06c8-ad79-2974-1fe05b00c7e7.htm">NanoXLSX</a><br />
    <strong>Assembly:</strong>
   NanoXLSX (in NanoXLSX.dll) Version: 1.8.7.0 (1.8.7)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EACA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">float</span> <span class="identifier">GetInternalColumnWidth</span>(
	<span class="identifier">float</span> <span class="parameter">columnWidth</span>,
	<span class="identifier">float</span> <span class="parameter">maxDigitWidth</span> = 7f,
	<span class="identifier">float</span> <span class="parameter">textPadding</span> = 5f
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">columnWidth</span></dt><dd>Type: <a href="https://docs.microsoft.com/dotnet/api/system.single" target="_blank" rel="noopener noreferrer">System<span id="LST264F4DA0_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST264F4DA0_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Single</a><br />Target column width (displayed in Excel)</dd><dt><span class="parameter">maxDigitWidth</span> (Optional)</dt><dd>Type: <a href="https://docs.microsoft.com/dotnet/api/system.single" target="_blank" rel="noopener noreferrer">System<span id="LST264F4DA0_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST264F4DA0_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Single</a><br />Maximum digit with of the default font (default is 7.0 for Calibri, size 11)</dd><dt><span class="parameter">textPadding</span> (Optional)</dt><dd>Type: <a href="https://docs.microsoft.com/dotnet/api/system.single" target="_blank" rel="noopener noreferrer">System<span id="LST264F4DA0_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST264F4DA0_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Single</a><br />Text padding of the default font (default is 5.0 for Calibri, size 11)</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="https://docs.microsoft.com/dotnet/api/system.single" target="_blank" rel="noopener noreferrer">Single</a><br />The internal column width in characters, used in worksheet XML documents</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="tableSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="2996192a-98c9-6032-6a5c-ac1ad0a85c71.htm">FormatException</a></td><td>Throws a FormatException if the column width is out of range</td></tr></table></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID3RBSection" class="collapsibleSection">
            The internal width deviates slightly from the column width, entered in Excel. Although internal, the default column width of 10 characters is visible in Excel as 10.71.
            The deviation depends on the maximum digit width of the default font, as well as its text padding and various constants.<br />
            In case of the width 10.0 and the default digit width 7.0, as well as the padding 5.0 of the default font Calibri (size 11), 
            the internal width is approximately 10.7142857 (rounded to 10.71).<br /> Note that the column height is not affected by this consideration. 
            The entered height in Excel is the actual height in the worksheet XML documents.<br /> 
            This method is derived from the Perl implementation by John McNamara (<a href="https://stackoverflow.com/a/5010899">https://stackoverflow.com/a/5010899</a>)<br />
            See also: <a href="https://www.ecma-international.org/publications-and-standards/standards/ecma-376/">ECMA-376, Part 1, Chapter 18.3.1.13</a></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="b79f8f28-87ab-475c-033b-b06d9b7b5d5f.htm">Utils Class</a></div><div class="seeAlsoStyle"><a href="a1c95b69-06c8-ad79-2974-1fe05b00c7e7.htm">NanoXLSX Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p>Copyright Raphael Stoeckli © 2022</p> </div></body></html>